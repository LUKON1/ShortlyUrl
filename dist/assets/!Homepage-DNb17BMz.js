import{u as y,r as i,j as e,T as $,m as g,A as P,a as A,b as I}from"./index-0xak3K6W.js";import{N as z,H as B}from"./h1-BLWf4zD9.js";import{u as F}from"./useAxiosPrivate-oWGE_ZDz.js";import{c as T,U as H}from"./utm_builder-DmOXWFlZ.js";import{P as Q}from"./wrapper_home-C7iTXIvV.js";function W({shortUrl:r}){const{t:n}=y(),[s,a]=i.useState("");return e.jsx("button",{type:"button",className:"touch-manipulation transition-all duration-200 ease-out hover:bg-blue-500 dark:hover:bg-rose-600 active:bg-blue-600 dark:active:bg-rose-700 bg-blue-400 dark:bg-rose-500 shadow-lg hover:shadow-xl h-16 lg:h-20 w-64 text-1xl md:text-2xl lg:text-3xl p-4 rounded-lg text-white dark:text-white font-extrabold",onClick:()=>{navigator.clipboard.writeText(r).then(()=>{a(!0),setTimeout(()=>{a("")},4e3)})},children:n(s?"homepage.copied":"homepage.copy")})}function R({isLoading:r}){const{t:n}=y(),{theme:s}=i.useContext($),a=s==="dark";return e.jsxs(g.button,{type:"submit",disabled:r,className:"motion-safe text-1xl group relative flex h-16 w-64 cursor-pointer touch-manipulation items-center justify-center overflow-hidden rounded-lg p-2 font-extrabold text-gray-900 shadow-lg hover:shadow-xl disabled:cursor-not-allowed disabled:opacity-50 md:text-2xl lg:h-20 lg:text-3xl dark:text-gray-100",initial:{opacity:0,transform:"translateY(100px)"},animate:{opacity:1,transform:"translateY(0px)",background:a?"linear-gradient(to right, #0ea5e9, #3b82f6)":"linear-gradient(to right, #0ea5e9, #2563eb)"},transition:{duration:.8,ease:"easeOut",delay:.2},whileHover:"hover",whileFocus:"hover",whileTap:{scale:.95},children:[e.jsx(g.div,{className:"absolute -top-4 right-32 z-10 h-40 w-40 rounded-full bg-blue-200 dark:bg-sky-800",style:{transition:"var(--transition-bg)"},variants:{hover:{top:4,scale:1.5,right:8}},transition:{duration:.5,ease:"easeOut"}}),e.jsx(g.div,{className:"absolute -top-4 right-2 z-10 h-32 w-32 rounded-full bg-slate-100 dark:bg-blue-900",style:{transition:"var(--transition-bg)"},variants:{hover:{top:4,scale:1.5,right:8}},transition:{duration:.5,ease:"easeOut"}}),e.jsx(g.div,{className:"absolute top-4 -right-12 z-10 h-24 w-24 rounded-full bg-blue-200 dark:bg-sky-800",style:{transition:"var(--transition-bg)"},variants:{hover:{top:4,right:8,scale:1.5}},transition:{duration:.5,ease:"easeOut"}}),e.jsx(g.div,{className:"absolute -top-4 right-20 z-10 h-16 w-16 rounded-full bg-sky-400 dark:bg-sky-600",style:{transition:"var(--transition-bg)"},variants:{hover:{top:4,right:8,scale:1.5}},transition:{duration:.5,ease:"easeOut"}}),e.jsx("p",{className:"relative z-10",children:n(r?"homepage.cutting":"homepage.cut")})]})}function J({qrCodeDataUrl:r,qrContainerRef:n}){return r?e.jsx("div",{ref:n,className:"relative flex flex-col items-center",children:e.jsx("img",{src:r,alt:"QR",className:"user-select-all h-64 w-64 object-contain border-5 rounded-4xl border-rose-300 dark:border-[#00a6f4]"})}):null}function V({qrCodeDataUrl:r,url:n}){const{t:s}=y(),a=()=>{if(!r)return;const m=new URL(n).hostname.split(".").slice(-2).join("."),c=document.createElement("a");c.href=r,c.download=`${m}-QRcode.png`,document.body.appendChild(c),c.click(),document.body.removeChild(c)};return e.jsx("div",{children:e.jsx("button",{onClick:a,type:"button",className:"touch-manipulation transition-all duration-200 ease-out hover:bg-blue-500 dark:hover:bg-rose-600 active:bg-blue-600 dark:active:bg-rose-700 bg-blue-400 dark:bg-rose-500 shadow-lg hover:shadow-xl h-16 lg:h-20 w-64 text-1xl md:text-2xl lg:text-3xl p-4 rounded-lg text-white dark:text-white font-extrabold",children:s("homepage.downloadqr")})})}const K=r=>{const n=window.location.host,a=[window.location.hostname,n];return new RegExp(`^(https?://)?(www.)?(${a.join("|")})(/|$)`,"i").test(r)};function L({id:r,icon:n,title:s,summary:a,isOpen:l,onToggle:u,children:d}){return e.jsxs("div",{className:"border-b border-sky-100 last:border-b-0 dark:border-slate-700/60",children:[e.jsxs("button",{type:"button",onClick:u,className:"flex w-full cursor-pointer touch-manipulation items-center gap-3 px-4 py-3 text-left transition-colors hover:bg-sky-50/50 md:px-5 md:py-3.5 dark:hover:bg-slate-700/30",children:[e.jsx("span",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-sky-100/80 text-sky-600 dark:bg-sky-900/40 dark:text-sky-400",children:n}),e.jsxs("div",{className:"flex min-w-0 flex-1 items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:s}),!l&&a&&e.jsx("span",{className:"truncate text-xs text-gray-400 dark:text-gray-500",children:a})]}),e.jsx("svg",{className:`h-4 w-4 shrink-0 text-gray-400 transition-transform duration-200 dark:text-gray-500 ${l?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx(P,{initial:!1,children:l&&e.jsx(g.div,{className:"motion-safe overflow-hidden",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25,ease:"easeInOut"},children:e.jsx("div",{className:"px-4 pt-1 pb-4 md:px-5 md:pb-5",children:d})})})]})}function q({value:r,onChange:n,options:s}){const{t:a}=y(),[l,u]=i.useState(!1),[d,m]=i.useState("1"),[c,k]=i.useState(86400),p=31536e3,v=[{label:a("homepage.urlopt.urtime.minutes"),value:60},{label:a("homepage.urlopt.urtime.hour"),value:3600},{label:a("homepage.urlopt.urtime.day"),value:86400},{label:a("homepage.urlopt.urtime.week"),value:604800},{label:a("homepage.urlopt.urtime.month"),value:2592e3},{label:a("homepage.urlopt.urtime.year"),value:31536e3}],w=s.some(t=>t.value===r),j=()=>{let o=(parseInt(d)||1)*c;o>p&&(o=p,m("1"),k(p)),o<60&&(o=60),n(o),u(!1)},f=t=>{t.key==="Enter"?(t.preventDefault(),j()):t.key==="Escape"&&u(!1)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.map(t=>e.jsx("button",{type:"button",onClick:()=>{n(t.value),u(!1)},className:`rounded-lg px-3 py-1.5 text-sm font-medium transition-colors ${r===t.value&&!l?"bg-sky-500 text-white shadow-sm dark:bg-sky-600":"bg-sky-50 text-gray-600 hover:bg-sky-100 dark:bg-slate-700 dark:text-gray-300 dark:hover:bg-slate-600"}`,children:t.label},t.value)),e.jsx("button",{type:"button",onClick:()=>u(!0),className:`rounded-lg px-3 py-1.5 text-sm font-medium transition-colors ${l||!w?"bg-sky-500 text-white shadow-sm dark:bg-sky-600":"bg-sky-50 text-gray-600 hover:bg-sky-100 dark:bg-slate-700 dark:text-gray-300 dark:hover:bg-slate-600"}`,children:a("homepage.urlopt.urtime.custom")})]}),e.jsx(P,{initial:!1,children:l&&e.jsx(g.div,{className:"motion-safe overflow-hidden",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2,ease:"easeInOut"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{autoFocus:!0,type:"number",min:"1",max:"999",value:d,onChange:t=>m(t.target.value),onKeyDown:f,className:"w-18 rounded-md border border-sky-200 bg-sky-50/50 px-2.5 py-1.5 text-sm text-gray-900 focus:border-sky-500 focus:ring-1 focus:ring-sky-500 focus:outline-none dark:border-slate-600 dark:bg-slate-900/60 dark:text-white"}),e.jsx("select",{value:c,onChange:t=>k(parseInt(t.target.value)),className:"flex-1 rounded-md border border-sky-200 bg-sky-50/50 px-2.5 py-1.5 text-sm text-gray-900 focus:border-sky-500 focus:ring-1 focus:ring-sky-500 focus:outline-none dark:border-slate-600 dark:bg-slate-900/60 dark:text-white",children:v.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("button",{type:"button",onClick:j,className:"shrink-0 rounded-md bg-sky-500 px-3 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-sky-600 dark:hover:bg-sky-400",children:a("homepage.urlopt.urtime.confirm")})]})})})]})}const X=e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Z=e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),G=e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})});function ee({urlTime:r,setUrlTime:n,urlTimeOptions:s,customAlias:a,setCustomAlias:l,utm:u,setUtm:d}){const{t:m}=y(),[c,k]=i.useState({lifetime:!0,alias:!1,utm:!1}),p=t=>{k(o=>({...o,[t]:!o[t]}))},v=s.find(t=>t.value===r)?.label||"",w=a?`${window.location.host}/${a}`:m("homepage.settings.aliasSummary"),f=Object.values(u).some(t=>t.trim()!=="")?Object.entries(u).filter(([,t])=>t.trim()).map(([t])=>t).join(", "):m("homepage.settings.utmSummary");return e.jsxs("div",{className:"w-full overflow-hidden rounded-xl border border-sky-100 bg-white/95 shadow-sm backdrop-blur-sm dark:border-slate-700 dark:bg-slate-800/95",children:[e.jsx(L,{id:"lifetime",icon:X,title:m("homepage.settings.lifetime"),summary:v,isOpen:c.lifetime,onToggle:()=>p("lifetime"),children:e.jsx(q,{value:r,onChange:n,options:s})}),e.jsx(L,{id:"alias",icon:Z,title:m("homepage.settings.alias"),summary:w,isOpen:c.alias,onToggle:()=>p("alias"),children:e.jsxs("div",{className:"flex items-center overflow-hidden rounded-md border border-sky-200 bg-sky-50/50 dark:border-slate-600 dark:bg-slate-900/60",children:[e.jsxs("span",{className:"shrink-0 border-r border-sky-200 bg-sky-100/80 px-2.5 py-2 text-xs font-medium text-sky-700 select-none dark:border-sky-800 dark:bg-sky-900/40 dark:text-sky-300",children:[window.location.host,"/"]}),e.jsx("input",{type:"text",value:a,onChange:t=>l(t.target.value.replace(/[^a-zA-Z0-9-_]/g,"")),placeholder:m("homepage.urlopt.aliasPlaceholder"),className:"w-full min-w-0 flex-1 bg-transparent px-2.5 py-2 text-sm text-gray-900 placeholder-gray-400 focus:outline-none dark:text-gray-100 dark:placeholder-gray-500",maxLength:30}),a.length>0&&e.jsxs("div",{className:"flex shrink-0 items-center gap-1.5 pr-2.5",children:[e.jsxs("span",{className:`text-xs select-none ${a.length<4?"text-amber-500 dark:text-amber-400":"text-gray-400 dark:text-gray-500"}`,children:[a.length,"/30"]}),e.jsx("button",{type:"button",onClick:()=>l(""),className:"flex h-5 w-5 cursor-pointer items-center justify-center rounded-full opacity-50 transition-opacity hover:opacity-100",children:e.jsx("img",{className:"h-3.5 w-3.5 dark:invert",src:T,alt:"Clear"})})]})]})}),e.jsx(L,{id:"utm",icon:G,title:m("homepage.settings.utm"),summary:f,isOpen:c.utm,onToggle:()=>p("utm"),children:e.jsx(H,{utmData:u,onChange:d})})]})}function te(){const r="/cut/shorter",n="http://localhost:5173",{t:s}=y(),{auth:a}=A(),l=a?.userId,u=F(),[d,m]=i.useState(""),[c,k]=i.useState(""),[p,v]=i.useState(!1),[w,j]=i.useState(""),[f,t]=i.useState(""),[o,M]=i.useState({source:"",medium:"",campaign:"",term:"",content:""}),b=i.useRef(),O=i.useRef(),U=[{value:2592e3,label:s("homepage.urlopt.urtime.month")},{value:604800,label:s("homepage.urlopt.urtime.week")},{value:86400,label:s("homepage.urlopt.urtime.day")},{value:3600,label:s("homepage.urlopt.urtime.hour")}],[N,E]=i.useState(U[0].value);i.useEffect(()=>{O.current.focus()},[]);const Y=i.useCallback(async S=>{if(S.preventDefault(),!d){b.current?.addNotification(s("message.urlblank"),3e3);return}try{if(K(d))throw new Error;let h=d;try{const x=new URL(h);o.source&&x.searchParams.set("utm_source",o.source),o.medium&&x.searchParams.set("utm_medium",o.medium),o.campaign&&x.searchParams.set("utm_campaign",o.campaign),o.term&&x.searchParams.set("utm_term",o.term),o.content&&x.searchParams.set("utm_content",o.content),h=x.toString()}catch(x){console.error("Invalid URL format for UTM appending",x)}v(!0);const D=await(l?u:I).post(r,JSON.stringify({url:h,urlTime:N,customAlias:f||void 0}),{headers:{"Content-Type":"application/json"}}),C=D?.data?.shortCode;if(!l){const x=JSON.parse(localStorage.getItem("anonymousLinks")||"[]");x.includes(C)||(x.push(C),localStorage.setItem("anonymousLinks",JSON.stringify(x)))}const _=`${n}/${C}`;k(_),j(D?.data?.qrCodeDataUrl)}catch(h){h?.response?h.response?.status===429?b.current?.addNotification(h.response.data.error||s("message.ratelimit"),5e3):h.response?.status===400?b.current?.addNotification(h.response.data.error||s("message.invalidurl"),3e3):h.response?.status===409?b.current?.addNotification(h.response.data.error||s("message.conflicterror"),3e3):b.current?.addNotification(s("message.urlcuterror"),3e3):b.current?.addNotification(s("message.servererror"),3e3)}finally{v(!1)}},[N,d,l,u,I,f,o]);return e.jsxs(e.Fragment,{children:[e.jsx(z,{ref:b}),e.jsxs("form",{onSubmit:Y,className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:grid md:grid-cols-[1fr_auto] md:items-start md:gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-4 md:max-w-6xl md:min-w-[40vw] md:items-stretch lg:min-w-[55vw]",children:[e.jsxs("div",{className:"relative flex flex-col items-center md:items-stretch",children:[d&&e.jsx("button",{className:"absolute top-1 left-1 z-10 flex cursor-pointer touch-manipulation items-center justify-center rounded-full p-0.5 md:top-2",onClick:()=>m(""),type:"button",children:e.jsx("img",{className:"h-6 w-6 opacity-40 transition-opacity hover:opacity-100 dark:invert",src:T,alt:"X"})}),e.jsx(g.input,{ref:O,className:"text-1xl h-16 w-3xs rounded-lg border-2 border-sky-400 bg-white p-2 text-center text-gray-900 shadow-md transition-none! focus:ring-2 focus:ring-sky-500 focus:outline-none md:h-16 md:w-full md:text-2xl lg:h-20 lg:text-3xl dark:border-sky-500 dark:bg-slate-800 dark:text-gray-100 dark:focus:ring-sky-400",initial:{opacity:0,transform:"translateY(100px)"},animate:{opacity:1,transform:"translateY(0px)"},transition:{duration:.8,ease:"easeOut",delay:.1},type:"url",value:d,onChange:S=>{const h=S?.target.value;m(h)},placeholder:s("homepage.placeholder")})]}),e.jsx("div",{className:"block md:hidden",children:e.jsx(R,{isLoading:p})}),e.jsx(g.div,{className:"motion-safe w-3xs md:w-full",initial:{opacity:0,transform:"translateY(100px)"},animate:{opacity:1,transform:"translateY(0px)"},transition:{duration:.6,ease:"easeOut",delay:.3},children:e.jsx(ee,{urlTime:N,setUrlTime:E,urlTimeOptions:U,customAlias:f,setCustomAlias:t,utm:o,setUtm:M})})]}),e.jsx("div",{className:"hidden md:block",children:e.jsx(R,{isLoading:p})})]}),c&&e.jsxs("div",{className:"mb-30 flex flex-col items-center",children:[e.jsxs("div",{className:"mb-30 flex flex-col items-center justify-center gap-5 md:flex-row md:gap-6",children:[e.jsx(g.div,{className:"text-1xl box-border flex h-16 w-3xs flex-col items-center justify-center overflow-hidden rounded-lg border-2 border-green-500 bg-green-50 p-2 text-center font-semibold text-green-700 shadow-lg transition-none! md:max-w-6xl md:min-w-[40vw] md:items-stretch md:text-2xl lg:h-20 lg:min-w-[55vw] lg:text-3xl dark:border-green-400 dark:bg-slate-800 dark:text-green-300",initial:{opacity:0,transform:"translateY(100px)"},animate:{opacity:1,transform:"translateY(0px)"},transition:{duration:.8,ease:"easeOut",delay:.2},children:e.jsx("span",{className:"select-all",children:c})}),e.jsx(g.div,{className:"motion-safe",initial:{opacity:0,transform:"translateY(100px)"},animate:{opacity:1,transform:"translateY(0px)"},transition:{duration:.8,ease:"easeOut",delay:.3},children:e.jsx(W,{shortUrl:c})})]}),e.jsxs(g.div,{className:"motion-safe flex flex-col gap-5 md:flex-col-reverse md:gap-8",initial:{opacity:0,transform:"translateY(100px)"},animate:{opacity:1,transform:"translateY(0px)"},transition:{duration:.8,ease:"easeOut",delay:.4},children:[e.jsx(J,{qrCodeDataUrl:w}),e.jsx(V,{qrCodeDataUrl:w,url:d})]})]})]})]})}function le(){const{t:r}=y();return e.jsxs(Q,{children:[e.jsx(B,{children:r("homepage.title")}),e.jsx(te,{})]})}export{le as default};
